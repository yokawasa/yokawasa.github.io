<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Accessing RBAC enabled Kubernetes Dashboard | Yoichi Kawasaki</title><meta name=keywords content="kubernetes,rbac"><meta name=description content="This is an article on how you can configure Service Account and RoleBinding in order to make Dashbaord work. As of release Kubernetes v1.7, Dashboard no longer has full admin privileges granted by default. All the privileges are revoked and only minimal privileges granted, that are required to make Dashboard work. With default priviledge, you&rsquo;ll see the following errors showed up on the Dashboard.
[Azure Kubernetes Service (AKS)] RBAC is enabled by default Since Azure CLI version 2."><meta name=author content="Yoichi Kawasaki"><link rel=canonical href=https://unofficialism.info/posts/accessing-rbac-enabled-kubernetes-dashboard/><link crossorigin=anonymous href=https://unofficialism.info/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=https://unofficialism.info/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://unofficialism.info/Thinking_Face_Emoji_large.png><link rel=icon type=image/png sizes=16x16 href=https://unofficialism.info/Thinking_Face_Emoji_large.png><link rel=icon type=image/png sizes=32x32 href=https://unofficialism.info/Thinking_Face_Emoji_large.png><link rel=apple-touch-icon href=https://unofficialism.info/Thinking_Face_Emoji_large.png><link rel=mask-icon href=https://unofficialism.info/Thinking_Face_Emoji_large.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Accessing RBAC enabled Kubernetes Dashboard"><meta property="og:description" content="This is an article on how you can configure Service Account and RoleBinding in order to make Dashbaord work. As of release Kubernetes v1.7, Dashboard no longer has full admin privileges granted by default. All the privileges are revoked and only minimal privileges granted, that are required to make Dashboard work. With default priviledge, you&rsquo;ll see the following errors showed up on the Dashboard.
[Azure Kubernetes Service (AKS)] RBAC is enabled by default Since Azure CLI version 2."><meta property="og:type" content="article"><meta property="og:url" content="https://unofficialism.info/posts/accessing-rbac-enabled-kubernetes-dashboard/"><meta property="og:image" content="https://unofficialism.info/profile.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-08-11T16:32:40+00:00"><meta property="article:modified_time" content="2018-08-11T16:32:40+00:00"><meta property="og:site_name" content="Yoichi Kawasaki"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://unofficialism.info/profile.jpg"><meta name=twitter:title content="Accessing RBAC enabled Kubernetes Dashboard"><meta name=twitter:description content="This is an article on how you can configure Service Account and RoleBinding in order to make Dashbaord work. As of release Kubernetes v1.7, Dashboard no longer has full admin privileges granted by default. All the privileges are revoked and only minimal privileges granted, that are required to make Dashboard work. With default priviledge, you&rsquo;ll see the following errors showed up on the Dashboard.
[Azure Kubernetes Service (AKS)] RBAC is enabled by default Since Azure CLI version 2."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://unofficialism.info/posts/"},{"@type":"ListItem","position":3,"name":"Accessing RBAC enabled Kubernetes Dashboard","item":"https://unofficialism.info/posts/accessing-rbac-enabled-kubernetes-dashboard/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Accessing RBAC enabled Kubernetes Dashboard","name":"Accessing RBAC enabled Kubernetes Dashboard","description":"This is an article on how you can configure Service Account and RoleBinding in order to make Dashbaord work. As of release Kubernetes v1.7, Dashboard no longer has full admin privileges granted by default. All the privileges are revoked and only minimal privileges granted, that are required to make Dashboard work. With default priviledge, you\u0026rsquo;ll see the following errors showed up on the Dashboard.\n[Azure Kubernetes Service (AKS)] RBAC is enabled by default Since Azure CLI version 2.","keywords":["kubernetes","rbac"],"articleBody":"This is an article on how you can configure Service Account and RoleBinding in order to make Dashbaord work. As of release Kubernetes v1.7, Dashboard no longer has full admin privileges granted by default. All the privileges are revoked and only minimal privileges granted, that are required to make Dashboard work. With default priviledge, you’ll see the following errors showed up on the Dashboard.\n[Azure Kubernetes Service (AKS)] RBAC is enabled by default Since Azure CLI version 2.0.40, RBAC is enabled by default. As you can see in the Azure command help, your cluster is RBAC enabled unless you specify --disable-rbac during the creation of the cluster.\n$ az --version azure-cli (2.0.43) $ az aks create --help --disable-rbac : Disable Kubernetes Role-Based Access Control. --enable-rbac -r [Deprecated] : Enable Kubernetes Role-Based Access Control. Default: enabled. Argument 'enable_rbac' has been deprecated and will be removed in a future release. Use '--disable-rbac' instead. Option 1: Access to Dashboard with your Service Account In option 1, I introduce how to give priviledge your Service Account and access to the Dashboard with the account. Actually there are a couple of authorization options, and here I introduce how to authorize with Bear Token\n[NOTE] According to this,\nAs of release 1.7 Dashboard supports user authentication based on:\nAuthorization: Bearer header passed in every request to Dashboard. Supported from release 1.6. Has the highest priority. If present, login view will not be shown. Bearer Token that can be used on Dashboard login view. Username/password that can be used on Dashboard login view (Disabled by default) Kubeconfig file that can be used on Dashboard login view 1-1. Create your Service Account for Dashboard access First of all, create your Service Account my-admin-user like this:\n$ kubectl create serviceaccount my-admin-user -n kube-system Or you can create the Service Account with the following YAML my-sa.yaml and deploying it with kubectl create -f my-sa.yaml:\n# my-sa.yaml apiVersion: v1 kind: ServiceAccount metadata: name: my-admin-user namespace: kube-system Check if your Service Account (my-admin-user) has been added.\n$ kubectl get sa -n kube-system NAME SECRETS AGE addon-http-application-routing-external-dns 1 9d addon-http-application-routing-nginx-ingress-serviceaccount 1 9d attachdetach-controller 1 9d certificate-controller 1 9d clusterrole-aggregation-controller 1 9d cronjob-controller 1 9d daemon-set-controller 1 9d default 1 9d deployment-controller 1 9d disruption-controller 1 9d endpoint-controller 1 9d generic-garbage-collector 1 9d heapster 1 9d horizontal-pod-autoscaler 1 9d job-controller 1 9d kube-dns 1 9d kube-proxy 1 9d kube-svc-redirector 1 9d kubernetes-dashboard 1 9d my-admin-user 1 15s namespace-controller 1 9d node-controller 1 9d persistent-volume-binder 1 9d pod-garbage-collector 1 9d pv-protection-controller 1 9d pvc-protection-controller 1 9d replicaset-controller 1 9d replication-controller 1 9d resourcequota-controller 1 9d route-controller 1 9d service-account-controller 1 9d service-controller 1 9d statefulset-controller 1 9d ttl-controller 1 9d tunnelfront 1 9d 1-2. Binding the role cluster-admin to the Service Account Create a ClusterRoleBinding which gives the role cluster-admin (= full admin priviledge) to the ServiceAccount my-admin-user\n$ kubectl create clusterrolebinding my-admin-user -n kube-system --clusterrole=cluster-admin --serviceaccount=kube-system:my-admin-user Or you can grant the priviledges with the following YAML my-sa-binding.yaml and deploying it with kubectl create -f my-sa-binding.yaml:\n# my-sa-binding.yaml apiVersion: rbac.authorization.k8s.io/v1beta1 kind: ClusterRoleBinding metadata: name: my-admin-user roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: my-admin-user namespace: kube-system 1-3. Authentication Option - Give Bear Token at Dashboard login view 1-3-1. Get the Token of the ServiceAccount $ kubectl get secret $(kubectl get serviceaccount my-admin-user -n kube-system -o jsonpath=\"{.secrets[0].name}\") -o jsonpath=\"{.data.token}\" -n kube-system | base64 --decode Or you can obtain the token step by step like this:\n# Get secret name for my-admin-user $ kubectl get serviceaccount my-admin-user -n kube-system -o yaml apiVersion: v1 kind: ServiceAccount metadata: creationTimestamp: 2018-08-11T06:53:34Z name: my-admin-user namespace: kube-system resourceVersion: \"1075968\" selfLink: /api/v1/namespaces/kube-system/serviceaccounts/my-admin-user uid: 44142169-9d33-11e8-b7d0-de454880a5dc secrets: - name: my-admin-user-token-nzp4f # Get secret string and base64 decoded it $ kubectl get secret my-admin-user-token-nzp4f -n kube-system -o jsonpath=\"{.data.token}\" | base64 --decode eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJteS1hZG1pbi11c2VyLXRva2VuLW56cDRmIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6Im15LWFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI0NDE0MjE2OS05ZDMzLTExZTgtYjdkMC1kZTQ1NDg4MGE1ZGMiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06bXktYWRtaW4tdXNlciJ9.2ulwCWd7MOnQjoecAY2NoleIxcHD8tda97ud3cK-kHWmdCodAejvddA4YjYozzBu2bWNA83aVTvKAn5-Uv1DC47U5FPh2LXAXNPXn4PyrdLO7TFZdHYmkvUgJKsg25vJvJmsWF9eQOinjjh_g16aGgdxrWz0NGJz5d1eE5GDP5NXXTTgxXlD_GFQduhlq8kc89dhpDUXMYe60-KzZvNaQhIskPsnxHMix1JrHEdtfciFhHRb2CBNjPWfcg455NGoS9S-k0qTfoIHYJC627p75E8TGqyTIa8TSg8vaif4XWgeg_OZWqEIGHTIrhEAGO4ElFijdZuzAg2-v9BGWe8i4q1i70ca5CwReJTG8t13eeOoEkq--VbhDAMY6rxmx-hi9dwf-zjsD233MdHJLh1yRi0eo_k5ov7fwDDsLQXeCTBIjSAzorvXseWr5m9sQ7yREbjDXCOsHbYo5xNV5ii-yOlxYyiqPxZZnnSwzllj1lwPDLSL0MyxkR9siF52vbkNDe6qdYYMqPtA-jTMIw_iLlB-WeN1Fx8423c4x5wV6IGPJZFuOYZhB0ra4jfRSS39vesaNodW8RjHUiuOSVA8_j-DxwOxa8prynALFWGswSMy6PfVQydouU6vammeqPBel9-IqBeTXY-57YumELG1PdcOcxdrBCZUlxBvJWbItxA 1-3-2. Give Bear Token at Dashboard login view Now that you have a bear token that you need to grant the full priviledges to your Service Account, let’s access to the Dashboard login view.\nFirst of all, create a proxy to the dashboard:\n$ kubectl proxy Starting to serve on 127.0.0.1:8001 Then, access to the Dashboard login page:\n$ open http://localhost:8001/api/v1/namespaces/kube-system/services/kubernetes-dashboard/proxy/#!/login Or if it’s on Azure, you can leverage Azure CLI command to access the Dashboard like this:\n$ az aks browse --resource-group --name $ open http://127.0.0.1:8001/#!/login You will see the following Dashboard login view. Choose Token option and enter the bear token you got above. You will be able to access and operate with the Dashboard without any errors. Easy login by giving Authorization header using Browser extention As introduced in here, install Requestly browser plugin and configure to make Dashboard use authorization header. You simply need to configure the plugin to pass the following header in accessing the dashboard:\nAuthorization: Bearer HERE is the example screen shot:\nOption2: Granting admin privileges to Dashboard’s Service Account In Option 2, I introduce how to give full privilege (role: cluster-admin) to the Dashboard’s Service Account kubernetes-dashboard. With this option, you can skip the authorization process that you do in the option 1 to access Dashboard. However, as mentioned here, granting admin privileges to Dashboard’s Service Account might be a security risk.\nFirst of all, create a ClusterRoleBinding which gives the role cluster-admin (= full admin priviledge) to the ServiceAccount kubernetes-dashboard\n$ kubectl create clusterrolebinding kubernetes-dashboard -n kube-system --clusterrole=cluster-admin --serviceaccount=kube-system:kubernetes-dashboard Or you can do the same with the following YAML dashboard-sa-binding.yaml and deploying it with kubectl create -f dashboard-sa-binding.yaml:\n# dashboard-sa-binding.yaml apiVersion: rbac.authorization.k8s.io/v1beta1 kind: ClusterRoleBinding metadata: name: kubernetes-dashboard labels: k8s-app: kubernetes-dashboard roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: kubernetes-dashboard namespace: kube-system Finally, access to the Dashboard. You’ll be able to access and operate without any errors.\nLINKS Access Control for Dashboard Service Account Permissions in Using RBAC Authorization @ kubernetesio, ","wordCount":"966","inLanguage":"en","datePublished":"2018-08-11T16:32:40Z","dateModified":"2018-08-11T16:32:40Z","author":{"@type":"Person","name":"Yoichi Kawasaki"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://unofficialism.info/posts/accessing-rbac-enabled-kubernetes-dashboard/"},"publisher":{"@type":"Organization","name":"Yoichi Kawasaki","logo":{"@type":"ImageObject","url":"https://unofficialism.info/Thinking_Face_Emoji_large.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://unofficialism.info accesskey=h title="unofficialism (Alt + H)">unofficialism</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://unofficialism.info/posts title=posts><span>posts</span></a></li><li><a href=https://unofficialism.info/works title=works><span>works</span></a></li><li><a href=https://unofficialism.info/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://unofficialism.info/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://unofficialism.info>Home</a>&nbsp;»&nbsp;<a href=https://unofficialism.info/posts/>Posts</a></div><h1 class=post-title>Accessing RBAC enabled Kubernetes Dashboard</h1><div class=post-meta><span title='2018-08-11 00:00:00 +0000 UTC'>August 11, 2018</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Yoichi Kawasaki&nbsp;|&nbsp;<a href=https://github.com/yokawasa/yokawasa.github.io/tree/master/content/posts/2018-08-11-accessing-rbac-enabled-kubernetes-dashboard.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>This is an article on how you can configure Service Account and RoleBinding in order to make Dashbaord work. As of release Kubernetes v1.7, Dashboard no longer has full admin privileges granted by default. All the privileges are revoked and only minimal privileges granted, that are required to make Dashboard work. With default priviledge, you&rsquo;ll see the following errors showed up on the Dashboard.</p><p><img loading=lazy src=https://unofficialism.info/assets/20180811-rbac-dashboard-auth-error.png alt></p><h2 id=azure-kubernetes-service-aks-rbac-is-enabled-by-default>[Azure Kubernetes Service (AKS)] RBAC is enabled by default<a hidden class=anchor aria-hidden=true href=#azure-kubernetes-service-aks-rbac-is-enabled-by-default>#</a></h2><p>Since Azure CLI version 2.0.40, RBAC is enabled by default. As you can see in the Azure command help, your cluster is RBAC enabled unless you specify <code>--disable-rbac</code> during the creation of the cluster.</p><pre tabindex=0><code>$ az --version
  azure-cli (2.0.43)

$ az aks create --help

    --disable-rbac                 : Disable Kubernetes Role-Based Access Control.
    --enable-rbac -r  [Deprecated] : Enable Kubernetes Role-Based Access Control. Default:
                                     enabled.
        Argument &#39;enable_rbac&#39; has been deprecated and will be removed in a future release. Use
        &#39;--disable-rbac&#39; instead.
</code></pre><h2 id=option-1-access-to-dashboard-with-your-service-account>Option 1: Access to Dashboard with your Service Account<a hidden class=anchor aria-hidden=true href=#option-1-access-to-dashboard-with-your-service-account>#</a></h2><p>In option 1, I introduce how to give priviledge your Service Account and access to the Dashboard with the account. Actually there are a couple of authorization options, and here I introduce how to authorize with Bear Token</p><p>[NOTE] According to <a href=https://github.com/kubernetes/dashboard/wiki/Access-control#authentication>this</a>,</p><blockquote><p>As of release 1.7 Dashboard supports user authentication based on:</p><ul><li>Authorization: Bearer header passed in every request to Dashboard. Supported from release 1.6. Has the highest priority. If present, login view will not be shown.</li><li><a href=https://github.com/kubernetes/dashboard/wiki/Access-control#bearer-token>Bearer Token</a> that can be used on Dashboard <strong>login view</strong>.</li><li><a href=https://github.com/kubernetes/dashboard/wiki/Access-control#basic>Username/password</a> that can be used on Dashboard <strong>login view</strong> (Disabled by default)</li><li><a href=https://github.com/kubernetes/dashboard/wiki/Access-control#kubeconfig>Kubeconfig</a> file that can be used on Dashboard <strong>login view</strong></li></ul></blockquote><h3 id=1-1-create-your-service-account-for-dashboard-access>1-1. Create your Service Account for Dashboard access<a hidden class=anchor aria-hidden=true href=#1-1-create-your-service-account-for-dashboard-access>#</a></h3><p>First of all, create your Service Account <code>my-admin-user</code> like this:</p><pre tabindex=0><code>$ kubectl create serviceaccount my-admin-user -n kube-system
</code></pre><p>Or you can create the Service Account with the following YAML <code>my-sa.yaml</code> and deploying it with <code>kubectl create -f my-sa.yaml</code>:</p><pre tabindex=0><code># my-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-admin-user
  namespace: kube-system
</code></pre><p>Check if your Service Account (<code>my-admin-user</code>) has been added.</p><pre tabindex=0><code>$ kubectl get sa -n kube-system

NAME                                                          SECRETS   AGE
addon-http-application-routing-external-dns                   1         9d
addon-http-application-routing-nginx-ingress-serviceaccount   1         9d
attachdetach-controller                                       1         9d
certificate-controller                                        1         9d
clusterrole-aggregation-controller                            1         9d
cronjob-controller                                            1         9d
daemon-set-controller                                         1         9d
default                                                       1         9d
deployment-controller                                         1         9d
disruption-controller                                         1         9d
endpoint-controller                                           1         9d
generic-garbage-collector                                     1         9d
heapster                                                      1         9d
horizontal-pod-autoscaler                                     1         9d
job-controller                                                1         9d
kube-dns                                                      1         9d
kube-proxy                                                    1         9d
kube-svc-redirector                                           1         9d
kubernetes-dashboard                                          1         9d
my-admin-user                                                 1         15s
namespace-controller                                          1         9d
node-controller                                               1         9d
persistent-volume-binder                                      1         9d
pod-garbage-collector                                         1         9d
pv-protection-controller                                      1         9d
pvc-protection-controller                                     1         9d
replicaset-controller                                         1         9d
replication-controller                                        1         9d
resourcequota-controller                                      1         9d
route-controller                                              1         9d
service-account-controller                                    1         9d
service-controller                                            1         9d
statefulset-controller                                        1         9d
ttl-controller                                                1         9d
tunnelfront                                                   1         9d
</code></pre><h3 id=1-2-binding-the-role-cluster-admin-to-the-service-account>1-2. Binding the role cluster-admin to the Service Account<a hidden class=anchor aria-hidden=true href=#1-2-binding-the-role-cluster-admin-to-the-service-account>#</a></h3><p>Create a <code>ClusterRoleBinding</code> which gives the role <code>cluster-admin</code> (= full admin priviledge) to the ServiceAccount <code>my-admin-user</code></p><pre tabindex=0><code>$ kubectl create clusterrolebinding my-admin-user -n kube-system --clusterrole=cluster-admin --serviceaccount=kube-system:my-admin-user
</code></pre><p>Or you can grant the priviledges with the following YAML <code>my-sa-binding.yaml</code> and deploying it with <code>kubectl create -f my-sa-binding.yaml</code>:</p><pre tabindex=0><code># my-sa-binding.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: my-admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: my-admin-user
  namespace: kube-system
</code></pre><h3 id=1-3-authentication-option---give-bear-token-at-dashboard-login-view>1-3. Authentication Option - Give Bear Token at Dashboard login view<a hidden class=anchor aria-hidden=true href=#1-3-authentication-option---give-bear-token-at-dashboard-login-view>#</a></h3><h4 id=1-3-1-get-the-token-of-the-serviceaccount>1-3-1. Get the Token of the ServiceAccount<a hidden class=anchor aria-hidden=true href=#1-3-1-get-the-token-of-the-serviceaccount>#</a></h4><pre tabindex=0><code>$ kubectl get secret $(kubectl get serviceaccount my-admin-user -n kube-system -o jsonpath=&#34;{.secrets[0].name}&#34;) -o jsonpath=&#34;{.data.token}&#34; -n kube-system | base64 --decode
</code></pre><p>Or you can obtain the token step by step like this:</p><pre tabindex=0><code># Get secret name for my-admin-user
$ kubectl get serviceaccount my-admin-user -n kube-system -o yaml

apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: 2018-08-11T06:53:34Z
  name: my-admin-user
  namespace: kube-system
  resourceVersion: &#34;1075968&#34;
  selfLink: /api/v1/namespaces/kube-system/serviceaccounts/my-admin-user
  uid: 44142169-9d33-11e8-b7d0-de454880a5dc
secrets:
- name: my-admin-user-token-nzp4f


# Get secret string and base64 decoded it
$ kubectl get secret my-admin-user-token-nzp4f -n kube-system -o jsonpath=&#34;{.data.token}&#34; | base64 --decode

eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJteS1hZG1pbi11c2VyLXRva2VuLW56cDRmIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6Im15LWFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI0NDE0MjE2OS05ZDMzLTExZTgtYjdkMC1kZTQ1NDg4MGE1ZGMiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06bXktYWRtaW4tdXNlciJ9.2ulwCWd7MOnQjoecAY2NoleIxcHD8tda97ud3cK-kHWmdCodAejvddA4YjYozzBu2bWNA83aVTvKAn5-Uv1DC47U5FPh2LXAXNPXn4PyrdLO7TFZdHYmkvUgJKsg25vJvJmsWF9eQOinjjh_g16aGgdxrWz0NGJz5d1eE5GDP5NXXTTgxXlD_GFQduhlq8kc89dhpDUXMYe60-KzZvNaQhIskPsnxHMix1JrHEdtfciFhHRb2CBNjPWfcg455NGoS9S-k0qTfoIHYJC627p75E8TGqyTIa8TSg8vaif4XWgeg_OZWqEIGHTIrhEAGO4ElFijdZuzAg2-v9BGWe8i4q1i70ca5CwReJTG8t13eeOoEkq--VbhDAMY6rxmx-hi9dwf-zjsD233MdHJLh1yRi0eo_k5ov7fwDDsLQXeCTBIjSAzorvXseWr5m9sQ7yREbjDXCOsHbYo5xNV5ii-yOlxYyiqPxZZnnSwzllj1lwPDLSL0MyxkR9siF52vbkNDe6qdYYMqPtA-jTMIw_iLlB-WeN1Fx8423c4x5wV6IGPJZFuOYZhB0ra4jfRSS39vesaNodW8RjHUiuOSVA8_j-DxwOxa8prynALFWGswSMy6PfVQydouU6vammeqPBel9-IqBeTXY-57YumELG1PdcOcxdrBCZUlxBvJWbItxA
</code></pre><h4 id=1-3-2-give-bear-token-at-dashboard-login-view>1-3-2. Give Bear Token at Dashboard login view<a hidden class=anchor aria-hidden=true href=#1-3-2-give-bear-token-at-dashboard-login-view>#</a></h4><p>Now that you have a bear token that you need to grant the full priviledges to your Service Account, let&rsquo;s access to the Dashboard login view.</p><p>First of all, create a proxy to the dashboard:</p><pre tabindex=0><code>$ kubectl proxy

Starting to serve on 127.0.0.1:8001
</code></pre><p>Then, access to the Dashboard login page:</p><pre tabindex=0><code>$ open http://localhost:8001/api/v1/namespaces/kube-system/services/kubernetes-dashboard/proxy/#!/login
</code></pre><p>Or if it&rsquo;s on Azure, you can leverage Azure CLI command to access the Dashboard like this:</p><pre tabindex=0><code>$ az aks browse --resource-group &lt;RESOURCE_GROUP&gt; --name &lt;CLUSTER_NAME&gt;
$ open http://127.0.0.1:8001/#!/login
</code></pre><p>You will see the following Dashboard login view. Choose <code>Token</code> option and enter the bear token you got above. You will be able to access and operate with the Dashboard without any errors.
<img loading=lazy src=https://unofficialism.info/assets/20180811-rbac-dashboard-login-view.png alt></p><h4 id=easy-login-by-giving-authorization-header-using-browser-extention>Easy login by giving Authorization header using Browser extention<a hidden class=anchor aria-hidden=true href=#easy-login-by-giving-authorization-header-using-browser-extention>#</a></h4><p>As introduced in <a href=https://github.com/kubernetes/dashboard/wiki/Access-control#authorization-header>here</a>, install <a href=https://chrome.google.com/webstore/detail/requestly-redirect-url-mo/mdnleldcmiljblolnjhpnblkcekpdkpa>Requestly browser plugin</a> and configure to make Dashboard use authorization header. You simply need to configure the plugin to pass the following header in accessing the dashboard:</p><pre tabindex=0><code>Authorization: Bearer &lt;token&gt;
</code></pre><p>HERE is the example screen shot:</p><p><img loading=lazy src=https://unofficialism.info/assets/20180811-rbac-requestly-sample-config.png alt></p><h2 id=option2-granting-admin-privileges-to-dashboards-service-account>Option2: Granting admin privileges to Dashboard&rsquo;s Service Account<a hidden class=anchor aria-hidden=true href=#option2-granting-admin-privileges-to-dashboards-service-account>#</a></h2><p>In Option 2, I introduce how to give full privilege (role: <code>cluster-admin</code>) to the Dashboard&rsquo;s Service Account <code>kubernetes-dashboard</code>. With this option, you can skip the authorization process that you do in the option 1 to access Dashboard. However, as mentioned <a href=https://github.com/kubernetes/dashboard/wiki/Access-control#admin-privileges>here</a>, granting admin privileges to Dashboard&rsquo;s Service Account might be a security risk.</p><p>First of all, create a <code>ClusterRoleBinding</code> which gives the role <code>cluster-admin</code> (= full admin priviledge) to the ServiceAccount <code>kubernetes-dashboard</code></p><pre tabindex=0><code>$ kubectl create clusterrolebinding kubernetes-dashboard -n kube-system --clusterrole=cluster-admin --serviceaccount=kube-system:kubernetes-dashboard
</code></pre><p>Or you can do the same with the following YAML <code>dashboard-sa-binding.yaml</code> and deploying it with <code>kubectl create -f dashboard-sa-binding.yaml</code>:</p><pre tabindex=0><code># dashboard-sa-binding.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: kubernetes-dashboard
  labels:
    k8s-app: kubernetes-dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: kubernetes-dashboard
  namespace: kube-system
</code></pre><p>Finally, access to the Dashboard. You&rsquo;ll be able to access and operate without any errors.</p><h2 id=links>LINKS<a hidden class=anchor aria-hidden=true href=#links>#</a></h2><ul><li><a href=https://github.com/kubernetes/dashboard/wiki/Access-control>Access Control for Dashboard</a></li><li><a href=https://kubernetes.io/docs/reference/access-authn-authz/rbac/#service-account-permissions>Service Account Permissions in Using RBAC Authorization @ kubernetesio</a>,</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://unofficialism.info/tags/kubernetes/>Kubernetes</a></li><li><a href=https://unofficialism.info/tags/rbac/>rbac</a></li></ul><nav class=paginav><a class=prev href=https://unofficialism.info/posts/quick-start-with-azure-function-v2-python-preview/><span class=title>« Prev Page</span><br><span>Quick Start with Azure Functions V2 Python (Preview)</span></a>
<a class=next href=https://unofficialism.info/posts/moving-to-jekyll-based-github-page/><span class=title>Next Page »</span><br><span>Moving to Jekyll based Github page</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Accessing RBAC enabled Kubernetes Dashboard on twitter" href="https://twitter.com/intent/tweet/?text=Accessing%20RBAC%20enabled%20Kubernetes%20Dashboard&url=https%3a%2f%2funofficialism.info%2fposts%2faccessing-rbac-enabled-kubernetes-dashboard%2f&hashtags=kubernetes%2crbac"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Accessing RBAC enabled Kubernetes Dashboard on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2funofficialism.info%2fposts%2faccessing-rbac-enabled-kubernetes-dashboard%2f&title=Accessing%20RBAC%20enabled%20Kubernetes%20Dashboard&summary=Accessing%20RBAC%20enabled%20Kubernetes%20Dashboard&source=https%3a%2f%2funofficialism.info%2fposts%2faccessing-rbac-enabled-kubernetes-dashboard%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Accessing RBAC enabled Kubernetes Dashboard on reddit" href="https://reddit.com/submit?url=https%3a%2f%2funofficialism.info%2fposts%2faccessing-rbac-enabled-kubernetes-dashboard%2f&title=Accessing%20RBAC%20enabled%20Kubernetes%20Dashboard"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Accessing RBAC enabled Kubernetes Dashboard on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2funofficialism.info%2fposts%2faccessing-rbac-enabled-kubernetes-dashboard%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://unofficialism.info>Yoichi Kawasaki</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>